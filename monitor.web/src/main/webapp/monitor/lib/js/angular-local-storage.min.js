!function(e,t,o){"use strict";function r(e){return function(){this.prefix="ls",this.storageType=e,this.cookie={expiry:30,path:"/"},this.notify={setItem:!0,removeItem:!1},this.setPrefix=function(e){return this.prefix=e,this},this.setStorageType=function(e){return this.storageType=e,this},this.setStorageCookie=function(e,t){return this.cookie.expiry=e,this.cookie.path=t,this},this.setStorageCookieDomain=function(e){return this.cookie.domain=e,this},this.setNotify=function(e,t){return this.notify={setItem:e,removeItem:t},this},this.$get=["$rootScope","$window","$document","$parse",function(e,t,o,r){var g,f=this,d=f.prefix,h=f.cookie,m=f.notify,S=f.storageType;o?o[0]&&(o=o[0]):o=document,"."!==d.substr(-1)&&(d=d?d+".":"");var p=function(e){return d+e},T=function(){try{var o=S in t&&null!==t[S],r=p("__"+Math.round(1e7*Math.random()));return o&&(g=t[S],g.setItem(r,""),g.removeItem(r)),o}catch(i){return S="cookie",e.$broadcast("LocalStorageModule.notification.error",i.message),!1}}(),y=function(t,o){if(o=n(o)?null:l(o),!T||"cookie"===f.storageType)return T||e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),m.setItem&&e.$broadcast("LocalStorageModule.notification.setitem",{key:t,newvalue:o,storageType:"cookie"}),M(t,o);try{g&&g.setItem(p(t),o),m.setItem&&e.$broadcast("LocalStorageModule.notification.setitem",{key:t,newvalue:o,storageType:f.storageType})}catch(r){return e.$broadcast("LocalStorageModule.notification.error",r.message),M(t,o)}return!0},v=function(t){if(!T||"cookie"===f.storageType)return T||e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),$(t);var o=g?g.getItem(p(t)):null;if(!o||"null"===o)return null;try{return JSON.parse(o)}catch(r){return o}},O=function(){var t,o;for(t=0;t<arguments.length;t++)if(o=arguments[t],T&&"cookie"!==f.storageType)try{g.removeItem(p(o)),m.removeItem&&e.$broadcast("LocalStorageModule.notification.removeitem",{key:o,storageType:f.storageType})}catch(r){e.$broadcast("LocalStorageModule.notification.error",r.message),_(o)}else T||e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),m.removeItem&&e.$broadcast("LocalStorageModule.notification.removeitem",{key:o,storageType:"cookie"}),_(o)},b=function(){if(!T)return e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),!1;var t=d.length,o=[];for(var r in g)if(r.substr(0,t)===d)try{o.push(r.substr(t))}catch(i){return e.$broadcast("LocalStorageModule.notification.error",i.Description),[]}return o},k=function(t){var o=d?new RegExp("^"+d):new RegExp,r=t?new RegExp(t):new RegExp;if(!T||"cookie"===f.storageType)return T||e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),x();var i=d.length;for(var n in g)if(o.test(n)&&r.test(n.substr(i)))try{O(n.substr(i))}catch(a){return e.$broadcast("LocalStorageModule.notification.error",a.message),x()}return!0},L=function(){try{return t.navigator.cookieEnabled||"cookie"in o&&(o.cookie.length>0||(o.cookie="test").indexOf.call(o.cookie,"test")>-1)}catch(r){return e.$broadcast("LocalStorageModule.notification.error",r.message),!1}}(),M=function(t,r,i){if(n(r))return!1;if((s(r)||c(r))&&(r=l(r)),!L)return e.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;try{var u="",g=new Date,f="";if(null===r?(g.setTime(g.getTime()+-864e5),u="; expires="+g.toGMTString(),r=""):a(i)&&0!==i?(g.setTime(g.getTime()+24*i*60*60*1e3),u="; expires="+g.toGMTString()):0!==h.expiry&&(g.setTime(g.getTime()+24*h.expiry*60*60*1e3),u="; expires="+g.toGMTString()),t){var d="; path="+h.path;h.domain&&(f="; domain="+h.domain),o.cookie=p(t)+"="+encodeURIComponent(r)+u+d+f}}catch(m){return e.$broadcast("LocalStorageModule.notification.error",m.message),!1}return!0},$=function(t){if(!L)return e.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;for(var r=o.cookie&&o.cookie.split(";")||[],i=0;i<r.length;i++){for(var n=r[i];" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(p(t)+"=")){var a=decodeURIComponent(n.substring(d.length+t.length+1,n.length));try{return JSON.parse(a)}catch(c){return a}}}return null},_=function(e){M(e,null)},x=function(){for(var e=null,t=d.length,r=o.cookie.split(";"),i=0;i<r.length;i++){for(e=r[i];" "===e.charAt(0);)e=e.substring(1,e.length);var n=e.substring(t,e.indexOf("="));_(n)}},w=function(){return S},E=function(e,t,o,n){n=n||t;var a=v(n);return null===a&&i(o)?a=o:c(a)&&c(o)&&(a=u(o,a)),r(t).assign(e,a),e.$watch(t,function(e){y(n,e)},c(e[t]))},R=function(){for(var e=0,o=t[S],r=0;r<o.length;r++)0===o.key(r).indexOf(d)&&e++;return e};return{isSupported:T,getStorageType:w,set:y,add:y,get:v,keys:b,remove:O,clearAll:k,bind:E,deriveKey:p,length:R,cookie:{isSupported:L,set:M,add:M,get:$,remove:_,clearAll:x}}}]}}var i=t.isDefined,n=t.isUndefined,a=t.isNumber,c=t.isObject,s=t.isArray,u=t.extend,l=t.toJson,g=t.module("LocalStorageModule",[]);g.provider("localStorageService",r("localStorage")),g.provider("sessionStorageService",r("sessionStorage"))}(window,window.angular);